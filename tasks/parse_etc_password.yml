---
- name: "PRELIM | {{ ubtu20cis_passwd_tasks }} | Parse {{ cis_etc_passwd_file }}"
  block:
      - name: "PRELIM | {{ ubtu20cis_passwd_tasks }} | Parse {{ cis_etc_passwd_file }}"
        command: "cat {{ cis_etc_passwd_file }}"
        changed_when: false
        check_mode: false
        register: ubtu20cis_passwd_file_audit

      - name: "PRELIM | {{ ubtu20cis_passwd_tasks }} | Split passwd entries"
        set_fact:
            ubtu20cis_passwd: "{{ ubtu20cis_passwd_file_audit.stdout|
                                  community.general.jc('passwd')|from_yaml|
                                  ansible.utils.replace_keys(target=cis_etc_passwd_keys) }}"
        vars:
            cis_etc_passwd_keys:
              - {before: comment, after: gecos}
              - {before: home, after: dir}
              - {before: username, after: id}
  tags:
      - always
